connect '/C=5'
setbaud 115200


:loop
sendln 'SKJOIN FE80:0000:0000:0000:3AE0:8E00:01B5:0890'
sendln ''
waitln 'EVENT 25' 'EVENT 24'
if result == 1 sendln ''
if result == 2 goto loop


sendln ''

:E7
sendln ''
sendbinary 'SKSENDTO 1 FE80:0000:0000:0000:3AE0:8E00:01B5:0890 0E1A 1 0 000E ' $10 $81 $00 $00 $05 $FF $01 $02 $88 $01 $62 $01 $E7 $00
sendln ''

waitln 'adfs'
sendln ''
frame = '1081000005FF010288016201E700'

; 文字数 → バイト数
strlen frame
lenByte = result / 2

; 整数配列を確保（intdim しか使えない）
;intdim binArray lenByte

sprintf2 length '%04X' lenByte
; SKSENDTO（データ長はバイト数）
sendln 'BINARRAY'
sendln ''
send 'SKSENDTO 1 FE80:0000:0000:0000:3AE0:8E00:01B5:0890 0E1A 1 0 ' length ' '

; 16進文字列 → バイト配列
for i 0 lenByte-1
    pos = i * 2 + 1
    strcopy frame pos 2 hex
    strbin = '$'
    strconcat strbin hex
    str2int bin strbin
    sendbinary bin
next
sendln ''

; 一括バイナリ送信
;sendbinary binArray

goto E7
